use AdventureWorks2012

select * from bramptondata 
where solddate < '2019/9/1'
order by solddate desc;

select * from bramptondata 
where solddate > '2019/9/1'
order by solddate desc;

select count(*) from bramptondata 
 where solddate >= '2019/9/1';
 
 select b.Type, avg([Sold Price]) from bramptondata as b 
group by b.Type
order by avg([Sold Price]) desc;

 select b.Type, Description, avg([Sold Price]) from bramptondata as b 
group by b.Type, Description
order by avg([Sold Price]) desc;

 select b.Type, Description, Bedroom, avg([Sold Price]) from bramptondata as b 
group by b.Type, Description, Bedroom
order by avg([Sold Price]) desc;

 select b.Type, Description, avg(Bedroom), avg([Sold Price]) from bramptondata as b 
group by b.Type, Description, Bedroom
order by avg([Sold Price]) desc;


 select count(b.Type) as type,Type, count(Description) as descp,Description, avg(Bedroom) bed, avg([Sold Price]) from bramptondata as b 
group by b.Type, Description, Bedroom
order by avg([Sold Price]) desc;

 select month(SoldDate) as sldmth, count(b.Type) as type,Type, count(Description) as descp,Description, avg(Bedroom) bed, avg([Sold Price]) from bramptondata as b 
group by b.Type, Description, Bedroom,SoldDate 
order by avg([Sold Price]) desc;

 select month(SoldDate) as sldmth,Type, Bedroom, avg([Sold Price])as soldprice from bramptondata as b 
group by month(SoldDate), b.Type, Description, Bedroom
order by month(SoldDate), avg([Sold Price]) desc;

select community, type, description, bedroom, Solddate, avg([Sold Price]) as AVGSoldPrice
from bramptondata
where Bedroom between 2 and 3
group by Solddate, community, type, description, bedroom
order by avg([Sold Price]) desc;

select bedroom, avg([Sold Price]) as AVGSoldPrice
from bramptondata
where Bedroom between 2 and 3
group by bedroom 
order by avg([Sold Price]) desc;

select community, type, description, bedroom, Solddate, avg([Sold Price]) as AVGSoldPrice
from bramptondata
where month(solddate) = 10
group by Solddate, community, type, description, bedroom
order by avg([Sold Price]) desc;

select community, type, description, bedroom, Solddate, count(SoldDate) as countSoldDate
from bramptondata
where month(solddate) between 9 and 10 
group by Solddate, community, type, description, bedroom
order by avg([Sold Price]) desc, solddate asc;

select * from tblDepartment
select * from tblEmployee
select * from tblTransaction

select * from tblTransaction as t
 inner join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber;

 select * from tblTransaction as t
 left join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber;


 select * from tblTransaction as t
 right join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber;

 select * from tblTransaction as t
  join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber;

 select * from tblTransaction as t
 inner join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber
 where EmployeeLastName like 'y%';

  select * from tblTransaction as t
 inner join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber
 where EmployeeLastName like '%y%';

  select * from tblTransaction as t
 inner join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber
 where EmployeeLastName like '%y%y%';

   select * from tblTransaction as t
 inner join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber
 where EmployeeLastName like '%a%a%t'

    select count(*) from tblTransaction as t
 inner join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber
 where EmployeeLastName like '%a%a%t'

    select * from tblTransaction as t
 inner join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber
 where EmployeeLastName like 'a%t'

select count(*), EmployeeLastName from tblTransaction as t
 inner join tblEmployee as e
 on e.EmployeeNumber = t.EmployeeNumber
 where EmployeeLastName like 'a%t'
 group by EmployeeLastName


 select * from tblTransaction as t 
 where EmployeeNumber in (126,127,128,129)
 order by EmployeeNumber

  select * from tblTransaction as t 
 where EmployeeNumber in (126,127,128,129) and year(dateoftransaction) = 2015
 order by EmployeeNumber;
 

   select * from tblTransaction as t 
 where EmployeeNumber in (126,127,128,129) or year(dateoftransaction) = 2015
 order by EmployeeNumber;

 select EmployeeNumber from tblEmployee where EmployeeLastName  like 'y%'

 select * from tblTransaction as t 
 where EmployeeNumber in
        ( select EmployeeNumber from tblEmployee where EmployeeLastName  like 'y%')
 order by EmployeeNumber;

  select * from tblTransaction as t 
 where EmployeeNumber in 
             ( select EmployeeNumber from tblEmployee where EmployeeLastName not like 'y%')
 order by EmployeeNumber;


   select * from tblTransaction as t 
 where EmployeeNumber not in 
         ( select EmployeeNumber from tblEmployee where EmployeeLastName like 'y%')
 order by EmployeeNumber;

  select * from tblTransaction as t 
 where EmployeeNumber = any
           ( select EmployeeNumber from tblEmployee where EmployeeLastName  like 'y%')
 order by EmployeeNumber;

   select * from tblTransaction as t 
 where EmployeeNumber <= any
           ( select EmployeeNumber from tblEmployee where EmployeeLastName  like 'y%')
 order by EmployeeNumber;

   select * from tblTransaction as t 
 where EmployeeNumber = some
           ( select EmployeeNumber from tblEmployee where EmployeeLastName  like 'y%')
 order by EmployeeNumber;


   select * from tblTransaction as t 
 where EmployeeNumber <> any
           ( select EmployeeNumber from tblEmployee where EmployeeLastName  like 'y%')
 order by EmployeeNumber;


   select * from tblTransaction as t 
 where EmployeeNumber <> all
           ( select EmployeeNumber from tblEmployee where EmployeeLastName  like 'y%')
 order by EmployeeNumber;


 select * from tblTransaction as t
 inner join (select * from tblEmployee where EmployeeLastName like 'y%') as e
 on e.EmployeeNumber = t.EmployeeNumber                                               
 order by t.EmployeeNumber
 -- derived table

